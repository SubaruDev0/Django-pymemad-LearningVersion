{% extends "email/base_email.html" %}
{% load i18n %}

{% block email_title %}{% trans "Contraseña actualizada - PymeMad" %}{% endblock %}

{% block header_icon %}
    <div class="header-icon">
        <div class="header-icon-inner">
            <span>✅</span>
        </div>
    </div>
{% endblock %}

{% block header_title %}{% trans "Contraseña Actualizada Exitosamente" %}{% endblock %}
{% block header_subtitle %}{% trans "Tu contraseña ha sido cambiada" %}{% endblock %}

{% block content %}
    <h2 class="greeting">{% trans "Hola" %} {{ user.get_full_name|default:user.username }},</h2>

    <p class="intro-text">
        {% trans "Te confirmamos que tu contraseña ha sido actualizada exitosamente." %}
    </p>

    <!-- Success alert -->
    <div class="alert-card success">
        <div>
            <span class="alert-icon">🔒</span>
            <h3 class="alert-title">{% trans "Cambio completado" %}</h3>
        </div>
        <p class="alert-text">
            {% trans "Tu contraseña ha sido cambiada correctamente. Ya puedes iniciar sesión con tu nueva contraseña." %}
        </p>
    </div>

    <!-- Info about the change -->
    <div class="tips-section">
        <h3 class="tips-title">
            <span style="display: inline-block; width: 30px; height: 30px; background: #2c5530; color: white; border-radius: 50%; line-height: 30px; text-align: center; margin-right: 8px; vertical-align: middle;">ℹ️</span>
            {% trans "Información del cambio" %}
        </h3>

        <div class="tip-item">
            <table class="tip-table">
                <tr>
                    <td class="tip-icon-cell">
                        <div class="tip-icon">
                            <div class="tip-icon-inner">📅</div>
                        </div>
                    </td>
                    <td class="tip-text">
                        {% trans "Fecha y hora del cambio:" %} {% now "j \d\e F \d\e Y, H:i" %}
                    </td>
                </tr>
            </table>
        </div>

        <div class="tip-item">
            <table class="tip-table">
                <tr>
                    <td class="tip-icon-cell">
                        <div class="tip-icon">
                            <div class="tip-icon-inner">📧</div>
                        </div>
                    </td>
                    <td class="tip-text">
                        {% trans "Cuenta asociada:" %} {{ user.email }}
                    </td>
                </tr>
            </table>
        </div>
    </div>

    <!-- CTA Button -->
    <div class="cta-container">
        <a href="{{ protocol }}://{{ domain }}{% url 'accounts:login' %}" class="cta-button">
            {% trans "Iniciar Sesión" %}
        </a>
    </div>

    <!-- Security warning -->
    <div class="alert-card danger">
        <div style="text-align: center;">
            <span class="alert-icon">⚠</span>
            <h3 class="alert-title">{% trans "¿No reconoces este cambio?" %}</h3>
        </div>
        <p class="alert-text">
            {% trans "Si no realizaste este cambio de contraseña, tu cuenta podría estar comprometida. Por favor, contáctanos inmediatamente y te ayudaremos a proteger tu cuenta." %}
        </p>
    </div>

    <!-- Next steps -->
    <div class="alternative-section">
        <h4 class="alternative-title">{% trans "Próximos pasos recomendados" %}</h4>
        <ul style="color: #6b7280; font-size: 14px; line-height: 1.6; margin: 12px 0; padding-left: 20px;">
            <li>{% trans "Cierra todas las sesiones activas en otros dispositivos" %}</li>
            <li>{% trans "Verifica tu información de seguridad y contacto" %}</li>
            <li>{% trans "Revisa tu actividad reciente en la cuenta" %}</li>
            <li>{% trans "Considera activar la autenticación de dos factores si está disponible" %}</li>
        </ul>
    </div>

    <!-- Contact info for security issues -->
    <div class="contact-section">
        <h3 class="contact-title">{% trans "¿Necesitas ayuda urgente?" %}</h3>
        <div class="contact-grid">
            <table class="contact-table">
                <tr>
                    <td class="contact-cell" style="width: 100%;">
                        <p class="contact-name" style="color: #dc2626; font-weight: 600;">
                            {% trans "Soporte de Seguridad" %}
                        </p>
                        <p class="contact-detail">
                            <span class="contact-icon">📞</span>
                            <a href="tel:+56999182981" style="color: #dc2626;">+56 9 12345678</a>
                        </p>
                        <p class="contact-detail">
                            <span class="contact-icon">✉</span>
                            <a href="mailto:seguridad@pymemad.cl" style="color: #dc2626;">seguridad@pymemad.cl</a>
                        </p>
                        <p style="color: #dc2626; font-size: 12px; margin-top: 8px;">
                            {% trans "Disponible 24/7 para problemas de seguridad" %}
                        </p>
                    </td>
                </tr>
            </table>
        </div>
    </div>
{% endblock %}

{% block footer_disclaimer %}
    <p class="footer-disclaimer">
        {% trans "Este es un mensaje automático de confirmación de seguridad. Por favor no respondas a este correo." %}<br>
        {% trans "Si no realizaste este cambio, contáctanos inmediatamente a través de los canales de seguridad indicados." %}
    </p>
{% endblock %}